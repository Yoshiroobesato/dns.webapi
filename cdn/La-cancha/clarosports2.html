<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Streaming en Vivo Ultra Avanzado</title>
    <link href="https://vjs.zencdn.net/7.20.3/video-js.min.css" rel="stylesheet">
    <link href="https://unpkg.com/@videojs/themes@1/dist/forest/index.css" rel="stylesheet">
    <style>
        body { margin: 0; background: #000; overflow: hidden; }
        .video-container { width: 100vw; height: 100vh; }
        .video-js { width: 100%; height: 100%; }
        .vjs-live-display { background-color: #ff0000; }
        .vjs-menu-button-popup .vjs-menu { background-color: rgba(0,0,0,0.8); }
    </style>
</head>
<body>
    <div class="video-container">
        <video-js id="my_video_1" class="vjs-theme-forest" controls preload="auto" autoplay muted>
            <source src="https://global.pricesaskeloadsc.com:443/global/clarosports2/index.m3u8?token=efb8c36ced64c8ed6a58e946fb4415920299a1ff-f3-1723286845-1723250845" type="application/x-mpegURL">
        </video-js>
    </div>

    <script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/videojs-contrib-eme@3.8.0/dist/videojs-contrib-eme.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-quality-levels/2.1.0/videojs-contrib-quality-levels.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-http-source-selector/1.1.6/videojs-http-source-selector.min.js"></script>
    <script>
        var player = videojs('my_video_1', {
            liveui: true,
            fluid: true,
            responsive: true,
            html5: {
                vhs: {
                    overrideNative: true,
                    fastQualityChange: true,
                    useBandwidthFromLocalStorage: true
                },
                nativeAudioTracks: false,
                nativeVideoTracks: false
            },
            controlBar: {
                children: [
                    'playToggle',
                    'volumePanel',
                    'currentTimeDisplay',
                    'timeDivider',
                    'durationDisplay',
                    'progressControl',
                    'liveDisplay',
                    'customControlSpacer',
                    'playbackRateMenuButton',
                    'qualitySelector',
                    'fullscreenToggle'
                ]
            }
        });

        player.httpSourceSelector();
        player.qualityLevels();

        player.ready(function() {
            this.hotkeys({
                volumeStep: 0.1,
                seekStep: 5,
                enableModifiersForNumbers: false
            });

            this.on('loadedmetadata', function() {
                var qualityLevels = this.qualityLevels();
                var currentQuality = qualityLevels[qualityLevels.selectedIndex];
                console.log('Calidad actual:', currentQuality ? currentQuality.height + 'p' : 'Auto');
            });

            this.on('error', function(e) {
                console.error('Error de reproducción:', this.error());
                this.load();
                this.play();
            });

            this.tech_.on('retryplaylist', function() {
                console.log('Reintentando cargar la lista de reproducción...');
            });

            this.on('fullscreenchange', function() {
                if (document.pictureInPictureElement) {
                    document.exitPictureInPicture();
                }
            });
        });

        // Mostrar estadísticas de streaming
        setInterval(function() {
            var statsEl = document.getElementById('stream-stats');
            if (!statsEl) {
                statsEl = document.createElement('div');
                statsEl.id = 'stream-stats';
                statsEl.style.position = 'absolute';
                statsEl.style.top = '10px';
                statsEl.style.left = '10px';
                statsEl.style.color = 'white';
                statsEl.style.backgroundColor = 'rgba(0,0,0,0.5)';
                statsEl.style.padding = '5px';
                document.querySelector('.video-container').appendChild(statsEl);
            }
            var stats = player.tech_.vhs.stats;
            statsEl.textContent = 'Bandwidth: ' + Math.round(stats.bandwidth / 1000) + ' kbps | Buffer: ' + Math.round(stats.buffered) + 's';
        }, 1000);
    </script>
</body>
</html>